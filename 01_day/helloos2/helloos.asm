; hello-os
; TAB=4

[org 0x7c00] ; 이 프로그램이 어디에 read되는가

; 이하는 표준적인 FAT12 포맷 플로피 디스크를 위한 기술

		db		0xeb, 0x4e, 0x90
		db		"HELLOIPL"	; boot sector의 이름은 자유롭게 써도 좋다(8바이트)
		dw		512		; 1섹터의 크기(512로 해야 함)
		db		1		; 클러스터의 크기(1섹터로 해야 함)
		dw		1		; FAT가 어디에서 시작될까(보통은 1섹터째부터)
		db		2		; FAT의 개수(2로 해야 함)
		dw		224		; 루트 디렉토리 영역의 크기(보통은 224엔트리로 한다)
		dw		2880		; 드라이브 크기(2880섹터 해야 함)
		db		0xf0		; 미디어 타입(0xf0해야 함
		dw		9		; FAT영역 길이(9섹터로 해야 함)
		dw		18		; 1트럭에 몇개의 섹터가 있을까(18로 해야 함)
		dw		2		; 헤드 수(2로 해야 함)
		dd		0		; 파티션을 사용하지 않기 때문에 여기는 반드시 0
		dd		2880		; 드라이브 크기를 한번 더 write
		db		0,0,0x29	; 잘 모르지만 이 값으로 해 두면 좋은 것 같다
		dd		0xffffffff	; 아마, 볼륨 시리얼 번호
		db		"HELLO-OS   "	; 디스크 이름(11바이트)
		db		"FAT12   "	; 포맷 이름(8바이트)
		resb	18			; 우선 18바이트를 비어둔다

; 프로그램 본체

		db		0xb8, 0x00, 0x00, 0x8e, 0xd0, 0xbc, 0x00, 0x7c
		db		0x8e, 0xd8, 0x8e, 0xc0, 0xbe, 0x74, 0x7c, 0x8a
		db		0x04, 0x83, 0xc6, 0x01, 0x3c, 0x00, 0x74, 0x09
		db		0xb4, 0x0e, 0xbb, 0x0f, 0x00, 0xcd, 0x10, 0xeb
		db		0xee, 0xf4, 0xeb, 0xfd

; 메세지 부분

		db		0x0a, 0x0a		; 개행을 2개
		db		"hello, world"
		db		0x0a			; 개행
		db		0

		times 510 - ($-$$) db 0 ; 510 byte까지를 0x00로 채우는 명령
		db		0x55, 0xaa

; 이하는 boot sector이외의 부분을 기술

		db		0xf0, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00
		resb	4600
		db		0xf0, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00
		resb	1469432
